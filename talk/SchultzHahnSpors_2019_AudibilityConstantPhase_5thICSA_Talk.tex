%\documentclass[mathserif]{intbeamer}
\documentclass[mathserif]{beamer}
%\usepackage{etex}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
%\usepackage{qrcode}
%\usepackage[space]{grffile}
\usepackage{subcaption}
\captionsetup[subfigure]{skip=-5pt} % global setting for subfigure
%\usepackage{aligned-overset}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{trfsigns}
\usepackage{gensymb}

\usepackage{../paper/macros}
\usepackage{xcolor}
\usepackage{enumerate}

\makeatletter
\def\mathcolor#1#{\@mathcolor{#1}}
\def\@mathcolor#1#2#3{%
  \protect\leavevmode
  \begingroup
    \color#1{#2}#3%
  \endgroup
}
\makeatother


%% *** Tikz, PGF and AudioIcons ***
%\usepackage{tikz, audioicons}
%\usetikzlibrary{calc,%
%  decorations.pathreplacing,%
  % decorations.markings,%
  % calc,%
  % arrows,%
  % through,%
  % intersections,%
  % positioning}

%\definecolor{activecolor}{RGB}{255, 0, 0}
% \definecolor{loudspeakercircle}{RGB}{236, 236, 236}
% \definecolor{focuscircle}{RGB}{254, 204, 0}
% \definecolor{darkgreen}{rgb}{0,0.5,0}
% \definecolor{orange}{rgb}{1.0,0.5,0}
% \definecolor{mauve}{RGB}{224,176,255}
% \definecolor{teal}{RGB}{64,224,208}

% \makeatletter
% \tikzset{
%   dot diameter/.store in=\dot@diameter,
%   dot diameter=3pt,
%   dot spacing/.store in=\dot@spacing,
%   dot spacing=10pt,
%   dots/.style={
%     line width=\dot@diameter,
%     line cap=round,
%     dash pattern=on 0pt off \dot@spacing
%   }
% }
% \makeatother

%% *** Importing Stuff ***
%\usepackage{import}

%% *** Mathsymbols ***
%\usepackage{soundfield}
%\sfrenewsymbol{cylm}{\mu}

%\usepackage{nicefrac}
%\DeclareFontFamily{U}{wncy}{}
%\DeclareFontShape{U}{wncy}{m}{n}{<->wncyr10}{}
%\DeclareSymbolFont{mcy}{U}{wncy}{m}{n}
%\DeclareMathSymbol{\Sha}{\mathord}{mcy}{"58}

%% *** Additional Commands extending Beamer ***
%\newcommand{\itemplus}[1][+]{\item[\textcolor{darkgreen}{\textbf{#1}}]}
%\newcommand{\itemminus}[1][--]{\item[\textcolor{red}{\textbf{#1}}]}
%\newcommand{\itemattent}[1][!\,]{\item[\textcolor{orange}{\textbf{#1}}]}
%\newcommand{\itemcheck}{\itemplus[$\checkmark$]}
%\newcommand{\itemcross}{\itemminus[$\boldsymbol{\times}$]}

%\newenvironment{itemizeblock}[1]{ %
%  \begin{block}{#1} %
%    \begin{itemize} %
%    } %
%    { %
%    \end{itemize} %
%  \end{block} %
%} %

\setbeamercovered{invisible}

% ===== titlepage info =====
\title[Audibility Constant Phase Shifts]%
  {Detection of Constant Phase Shifts in\\Filters for Sound Field Synthesis}

\author[Schultz, Hahn, Spors]{%
    \underline{Frank Schultz},
    Nara Hahn,
    Sascha Spors
}

\date[2019-09-28]{%
  %\raisebox{0mm}{\includegraphics[width=4.5cm]{graphics/icsa-2019.png}}
  5th INTERNATIONAL CONFERENCE ON SPATIAL AUDIO, September 26th to 28th, 2019,
  Ilmenau, Germany
}

\institute[]{Research Group Signal Processing and Virtual Acoustics\\University of Rostock}

% ===== remove total number of slides from pagenumber =====
%\setbeamertemplate{page number in head/foot}[nototal]
%\setbeamersize{text margin left=\logomargin}
%\setbeamertemplate{blocks}[rounded]
%\setbeamercolor{block title}{fg=black, bg=white}

\begin{document}
\maketitle
%
%
%
\section{Introduction}
%
\begin{frame}[label=introslide]{Ideal Constant Phase Shift}
Audibility of constant phase shift?
\begin{figure}
\includegraphics[width=1\textwidth]{graphics/ideal-spectra-and-square-waves}
\end{figure}
%
Literature audibility of group delay / phase distortions:

\begin{itemize}
\setlength\itemsep{-0.1em}
\scriptsize
\item V. Hansen et al. (1974):
"On aural \textcolor{colnonzero}{phase} detection: Part I,II." \textit{JAES} \textbf{22}(1,10)
\item J. Blauert  et al. (1978): "\textcolor{colnonzero}{Group delay distortions}
in electroacoustical systems."
\textit{JASA} \textbf{63}(5)
\item H. Suzuki et al. (1980): "On the perception of
\textcolor{colnonzero}{phase distortions}."
\textit{JAES} \textbf{28}(9)
\item S. Lipshitz et al. (1982): "On the audibility of
\textcolor{colnonzero}{midrange phase distortion} in audio systems."
\textit{JAES} \textbf{30}(9)
\item H. MÃ¸ller et al. (2007):
"On the audibility of \textcolor{colnonzero}{all-pass phase}
in electroacoustical transfer functions."
\textit{JAES} \textbf{55}(3)
\item M. Laitinen (2013): "Sensitivity of Human Hearing to Changes in
\textcolor{colnonzero}{Phase} Spectrum." \textit{JAES} \textbf{61}(11)
%\item H. Fastl, E. Zwicker (2007): "\textit{Psychoacoustics}", Springer, Berlin
\end{itemize}
\end{frame}
%
%
%
\begin{frame}{Sound Field Synthesis (SFS) with Linear / Planar Arrays}
\begin{columns}[T]
\column{0.33\textwidth}
2.5-dimensional SFS

\hspace{1cm}\includegraphics[width=0.5\textwidth]{graphics/lineararray}
\column{0.67\textwidth}
\only<1>{
ideal \textcolor{colnonzero}{half-derivative} EQ for infinite linear array

\includegraphics[width=1\textwidth]{graphics/equalizer-ideal-line-source}
}
\only<2>{
ideal half-derivative EQ for infinite linear array

\includegraphics[width=1\textwidth]{graphics/equalizer-ideal-line-source}
}
\only<3>{
ideal half-derivative EQ for infinite linear array

\includegraphics[width=1\textwidth]{graphics/equalizer-ideal-line-source}
}
\end{columns}
\vspace{0.25cm}
\begin{columns}[T]
\column{0.33\textwidth}
\only<1>
{
3-dimensional SFS

\includegraphics[width=1\textwidth]{graphics/planararray}
}
\column{0.67\textwidth}
\only<1>{
ideal \textcolor{colnonzero}{full-derivative} EQ for infinite planar array

\includegraphics[width=1\textwidth]{graphics/equalizer-ideal-plane-source}
}
\only<2>{
half-derivative slope for finite length array, minimum phase

\includegraphics[width=1\textwidth]{graphics/equalizer-minimum-phase}
}
\only<3>{
half-derivative slope for finite length array, linear phase

\includegraphics[width=1\textwidth]{graphics/equalizer-linear-phase}
}
\end{columns}
\end{frame}
%
%
%
\againframe{introslide}
%
%
%
\section{Signal Processing Theory}
\begin{frame}{Fractional Hilbert Transform / Constant Phase Shift $\varphi$}
\begin{columns}[T]
%
\column{0.45\textwidth}
Discrete-time \underline{infinite} impulse response
\begin{align*}
h[n] = \cos\varphi\cdot\mathcolor{colzerotalk}{\delta[n]}
- \sin\varphi \cdot
\underbrace{
\begin{cases}
\mathcolor{colnonzero}{0},& \text{$n$ even}\\
\mathcolor{colnonzero}{\tfrac{2}{n\pi}},& \text{$n$ odd}
\end{cases}
}_{\text{Hilbert transform }\hh[n]}
\end{align*}
%
DTFT spectrum over $\Omega=2 \pi \frac{f}{f_s}$
\vspace*{-0.3cm}
\begin{align*}
H(\Omega)
&= \cos\varphi \cdot \mathcolor{colzerotalk}{1}
- \sin\varphi\cdot
\underbrace{(\mathcolor{colnonzero}{-\im\cdot\text{sgn}(\Omega)})}_{\text{Hilbert transform}}
%\end{align*}
%\vspace*{-0.3cm}
%\begin{align*}
\\
&=
\begin{cases}
\e^{+\im\varphi}, & 0 < \Omega < \pi\\
\e^{-\im\varphi}, & -\pi < \Omega < 0\\
\cos\varphi, & \Omega = 0, \pi
\end{cases}
\end{align*}
%
\column{0.4\textwidth}
\only<1>{
  \begin{figure}
    \includegraphics[width=1\textwidth]{graphics/discrete-ir}
  \end{figure}
}
\only<2>{
  \begin{figure}
    \includegraphics[width=1\textwidth]{graphics/discrete-ir-phi-180}
  \end{figure}
}
\only<3>{
  \begin{figure}
    \includegraphics[width=1\textwidth]{graphics/discrete-ir-phi-90}
  \end{figure}
}
\only<4>{
  \begin{figure}
    \includegraphics[width=1\textwidth]{graphics/discrete-ir-phi-45}
  \end{figure}
}
\only<5>{
  \begin{figure}
    \includegraphics[width=1\textwidth]{graphics/discrete-ir-phi45}
  \end{figure}
}
%
\begin{figure}
%\vspace*{+0.5cm}
%\hspace*{-1.9cm}
\includegraphics[width=1\textwidth]{graphics/ideal-phase-responses}
\end{figure}
\end{columns}
\end{frame}
%
%
%
\begin{frame}{Finite Length Filter of Fractional Hilbert Transform}
\begin{figure}
\includegraphics[width=1\textwidth]{graphics/spectra_filterorder510}
\end{figure}

\begin{itemize}
\item for $\varphi=\pm 180\degree$: perfect phase and perfect magnitude, i.e. inverted Dirac impulse
\item for $\varphi=\pm 90\degree$: perfect phase, largest magnitude deviation
\item for all other $\varphi$ at lowest / highest frequencies:\\
magnitude convergence to $\cos\varphi$ and phase convergence to $0\degree$ or $180\degree$
\end{itemize}
\end{frame}
%
%
%
\section{Example: Transient Signal}
\begin{frame}{Example: Constant Phase Shift for Transient Signal}
\only<1>
{
Original signal $x[n]$
\begin{figure}
\includegraphics[width=\textwidth]{graphics/original}
\end{figure}
}
\only<2>
{
Original signal $x[n]$ and treatment Hilbert transform $x_\Hilbert[n]$
\begin{figure}
\includegraphics[width=\textwidth]{graphics/original-hilbert}
\end{figure}
}
\only<3>
{
Original $x[n]$, treatment Hilbert transform $x_\Hilbert[n]$ and envelope
$\pm\sqrt{x[n]^2+x_\Hilbert[n]^2}$
\begin{figure}
\includegraphics[width=\textwidth]{graphics/original-hilbert-envelope}
\end{figure}
}
\only<4>
{
Treatment $x[n]\ast h[n]$ for different constant phase shifts $\varphi$
\begin{figure}
\includegraphics[width=\textwidth]{graphics/envelope-phaseshifts}
\end{figure}
}
\only<5>
{
Audibility of the treatment Hilbert transform ($\varphi=-90\degree$) against original ?!
\begin{figure}
\includegraphics[width=\textwidth]{graphics/original-hilbert-envelope-phaseshifts}
\end{figure}
}
\end{frame}
%
%
%
\section{Listening Experiment}
%
\begin{frame}{Listening Experiment: Audio Material \& Conditions}
%\begin{tikzpicture}[remember picture,overlay]
%\node at (9,-5) {\includegraphics[width=0.5\textwidth]{graphics/abx_gui}};
%\end{tikzpicture}
%
\textbf{4x Audio}
\begin{itemize}
\item square wave bursts 50 Hz, 200 ms on, 300ms off, sin$^\text{2}$ fades
\item 300 Hz-lowpass filtered pink noise
\item castanets (anechoic by Matthias Frank)
\item music excerpt with percussion, drums (Eagles, Hotel California, Hell freezes over, 1994)
\end{itemize}
%
\vspace*{0.25cm}
%
\textbf{5x Treatment}: Constant Phase Shift vs. Original ($\varphi = 0\degree$)
\begin{enumerate}[I]
\item square wave bursts with $\mathcolor{colnonzero}{\varphi=-90\degree}$
\item square wave bursts with $\mathcolor{colzerotalk}{\varphi=-45\degree}$
\item lowpass filtered pink noise with $\mathcolor{colnonzero}{\varphi=-90\degree}$
\item castanets with $\mathcolor{colnonzero}{\varphi=-90\degree}$
\item Hotel California with $\mathcolor{colnonzero}{\varphi=-90\degree}$
\end{enumerate}
\end{frame}
%
%
%

\begin{frame}{Listening Experiment: ABX Test with webMUSHRA}
\begin{tikzpicture}[remember picture,overlay]
\node at (current page.center) {\includegraphics[width=\textwidth]{graphics/abx_gui}};
\node at (9.5,-1.4)
{
\begin{tabular}{ |c|c|c| }
 \hline
 X & A & B \\\hline
 original & phase & original \\
 phase & phase & original \\
 original & original & phase \\
 phase & original & phase \\
 \hline
\end{tabular}
};
\node at (3,-4){\tiny\url{https://www.audiolabs-erlangen.de/resources/webMUSHRA}};
\end{tikzpicture}
\end{frame}
%
%
%
\begin{frame}{ABX / $\chi^2$ Test Statistic Considerations}
%\textbf{Sloppy} formulation of our research question:

%Is the number of correct answers (either A=X or B=X was correctly discriminated)
%high enough that we can exclude pure guessing?
%\vspace{0.25cm}

\textbf{Pre hoc} for individual participants:
\begin{itemize}
\item
null hypothesis $\Hnull(p_\text{detect}=0.5)$, i.e. pure guessing
%\item
%subjects are to rate 5 treatments $\rightarrow$ Bonferroni correction for
%individual $\alpha_\text{I...V}, \beta_\text{I...V}$
\item
target rejection level $\alpha=0.05$,
%\item
target test power $1-\beta = 0.95$

\item
assumed $p_\text{detect}=0.9$ (effect size $g=0.4$)
\item
per \textcolor{colnonzero}{audio content}
for $\frac{\geq 19\,\text{correct trials}}{25\,\text{total trials}}
\rightarrow p_\text{Binomial PDF}<\frac{\alpha}{5} \rightarrow\Hnull$
can be rejected
\end{itemize}
%
\vspace{0.25cm}

\textbf{Post hoc} for tested population (cumulated frequencies):

\begin{itemize}
\item per \textcolor{colnonzero}{audio content}: comparison against 50:50 answering
\item 10 pairwise comparisons over all \textcolor{colnonzero}{audio contents}: same rating for different content?
\end{itemize}
using $p_{\chi^2 \text{PDF}}$ for small / medium effect size
\end{frame}
%
%
%
\begin{frame}{Listening Experiment: Procedure}
\begin{itemize}
\item experiments conducted in our audio lab %, 40 $\text{dB(A)}_\text{Leq}$ noise floor, mean RT 0.3 s
\item diotic playback via \textcolor{colnonzero}{headphone} Sennheiser HD 800 (dynamic, open)
\item stimuli ITU-R BS.1770-4 loudness matched (except castanets)
\item playback at 73 $\text{dB(A)}_\text{Leq}$ / 88 $\text{dB(C)}_\text{Peak}$
for fullband pink noise
\end{itemize}
\begin{figure}
\includegraphics[width=0.65\textwidth]{graphics/URO_array_panorama_2}
\includegraphics[width=0.215\textwidth]{graphics/HD800_2}
\end{figure}
\begin{itemize}
%age $a$: $\hat{\mu}_a=29.8$, $\hat{\sigma}_a=6.5$ years,
%percentiles $a_{0.05}=22.6,~a_{0.25}=25,~a_{0.5}=28,~a_{0.75}=32,~a_{0.95}=40.5$ years
\item ratings: 5 treatments x 25 trials per treatment x 12 participants (4 female, 8 male)
\item fully randomized stimuli sequence
\end{itemize}
\end{frame}
%
%
%
\begin{frame}{Listening Experiment: Results}
\only<1>{
ABX / Binomial
\begin{figure}
\includegraphics[width=0.75\textwidth]{graphics/scatter}
\end{figure}
}
\only<2>{
Contingency Tables / $\chi^2$
\begin{figure}
\includegraphics[width=0.75\textwidth]{graphics/scatter-with-chitest}
\end{figure}
}
\only<3>{
Trial Decision Time
\tiny
%measured as start to finish of trial, but not as pure playback time...thus many outliers
\begin{figure}
\includegraphics[width=0.75\textwidth]{graphics/boxplot_time}
\end{figure}
}
\end{frame}
%
%
%
\section{Conclusion}
\begin{frame}{Conclusion}
Audibility constant phase shift$\rightarrow$ yes
%\begin{itemize}
%\item constant phase shifter is known as fractional Hilbert transform
%\item audibility depends on audio material and amount of constant phase shift
%\end{itemize}

\begin{columns}[c]
\column{0.4\textwidth}
\begin{figure}
%\includegraphics[width=1\textwidth]{graphics/spectra_filterorder510}
\includegraphics[width=0.8\textwidth]{graphics/original-hilbert}
\includegraphics[width=0.9\textwidth]{graphics/scatter}
\end{figure}
\column{0.55\textwidth}
\only<1>{

\textbf{Discrimination of phase shift against original}
\begin{itemize}
\item very sensitive to square wave bursts
\item likely sensitive for transient signals and lowpass filtered noise
\item audibility for musical content not yet shown
\item training improves sensitivity...
\end{itemize}
}
\only<2>{

\textcolor{colnonzero}{\textbf{Outlook}}

trained experts achieve

%\textcolor{colnonzero}{pink noise}: 40 correct detections $(p<2.1 \cdot 10^{-10})$
%\textcolor{colnonzero}{castanets}: 28 correct $(p<0.022)$ and 39 correct $(p<2.9\cdot10^{-9})$

\textcolor{colnonzero}{pink noise} $\mathcolor{colnonzero}{\varphi=-90\degree}$:
95\% (***)

\textcolor{colnonzero}{castanets} $\mathcolor{colnonzero}{\varphi=-90\degree}$:
92\% (***)
%\vspace*{0.5cm}

\begin{tiny}
ABX test design with assumed effect size $g =	0.25$,
$\alpha = 0.05$, power $1-\beta=0.95 \rightarrow
\frac{\geq 27\,\text{correct trials}}{42\,\text{total trials}}$
\end{tiny}

\vspace{0.4cm}

psychometric function \textcolor{colnonzero}{detection over} $\mathcolor{colnonzero}{\varphi}$

}
\end{columns}
\end{frame}
%
%
%
\author[Schultz, Hahn, Spors]{%
    Frank Schultz,
    Nara Hahn,
    Sascha Spors
}
\institute[]{Research Group Signal Processing and Virtual Acoustics\\University of Rostock}
\date[]{This project supports open science: https://doi.org/10.5281/zenodo.\textcolor{colnonzero}{3383286}}
\maketitle
%
%
%
\section{Appendix}
%
%
%
\begin{frame}[noframenumbering]{Periodic Convolution}
Impulse response for $\varphi=-\frac{\pi}{4}$
\begin{figure}
\includegraphics[width=0.75\textwidth]{graphics/periodic-ir}
\end{figure}
\end{frame}
%
%
%
\begin{frame}[noframenumbering]{Quantization Filter Coefficients}
\begin{figure}
\includegraphics[width=\textwidth]{graphics/amplitude-decay}
\end{figure}
\end{frame}
%
%
%
\begin{frame}[noframenumbering]{Crest Factor}
\begin{figure}
\includegraphics[width=\textwidth]{graphics/crest-factor-and-square-waves}
\end{figure}
\end{frame}
%
%
%
\begin{frame}[noframenumbering]{Crest Factor}
\begin{figure}
\includegraphics[width=\textwidth]{graphics/crest-factor}
\end{figure}
\end{frame}
%
%
%
\begin{frame}[noframenumbering]{Audio Content Spectra}
\begin{figure}
\includegraphics[width=\textwidth]{graphics/stimuli-spectra}
\end{figure}
\end{frame}
%
%
%
\end{document}
